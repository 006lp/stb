import"./base-Ca4tGcLM.js";import{E as x,f as m,a as C}from"./formatDate-Cq64O7Br.js";import{_ as B,l as v,o as E,c as T,a as s,w as l,g as n,t as c,Z as $,v as b,B as w,A as u,j as i,k as A}from"./index-VChYWv4H.js";const S={class:"users"},U={__name:"Users",setup(D){const d=v([]),_=v(!1),p=async()=>{_.value=!0;try{const o=await u.get("/api/admin/users");d.value=o.data}catch{i.error("获取用户列表失败")}finally{_.value=!1}},h=async o=>{var r,e;try{const t=o.status==="active"?"disabled":"active";await u.patch(`/api/admin/users/${o._id}/status`,{status:t}),i.success("状态更新成功"),p()}catch(t){i.error((e=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:e.error)}},g=async o=>{var r,e;try{const t=o.role==="admin"?"user":"admin";await u.patch(`/api/admin/users/${o._id}/role`,{role:t}),i.success("角色更新成功"),p()}catch(t){i.error((e=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:e.error)}};return E(p),(o,r)=>{const e=x,t=$,f=w,y=C;return A(),T("div",S,[s(y,{data:d.value,"scrollbar-always-on":!0,fit:""},{default:l(()=>[s(e,{prop:"username",label:"用户名",fixed:""}),s(e,{prop:"name",label:"IP地址"},{default:l(({row:a})=>[n(c(a.ip.ipv4||a.ip.ipv6),1)]),_:1}),s(e,{prop:"email",label:"注册邮箱"}),s(e,{prop:"role",label:"角色"},{default:l(({row:a})=>[n(c(a.role==="admin"?"管理员":"用户"),1)]),_:1}),s(e,{prop:"date",label:"状态"},{default:l(({row:a})=>[s(t,{color:a.status==="active"?"green":"red"},{default:l(()=>[n(c(a.status==="active"?"活跃":"禁用"),1)]),_:2},1032,["color"])]),_:1}),s(e,{prop:"createdAt",label:"注册时间"},{default:l(({row:a})=>[n(c(b(m)(a.createdAt)),1)]),_:1}),s(e,{prop:"lastLogin",label:"最后登录"},{default:l(({row:a})=>[n(c(b(m)(a.lastLogin)),1)]),_:1}),s(e,{label:"操作",fixed:"right"},{default:l(({row:a})=>[s(f,{type:"link",onClick:k=>h(a)},{default:l(()=>[n(c(a.status==="active"?"禁用":"启用"),1)]),_:2},1032,["onClick"]),s(f,{type:"link",onClick:k=>g(a)},{default:l(()=>[n(c(a.role==="admin"?"设为用户":"设为管理员"),1)]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])}}},R=B(U,[["__scopeId","data-v-f9c883c4"]]);export{R as default};
