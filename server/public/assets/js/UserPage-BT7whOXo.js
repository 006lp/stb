import{u as a,b as l,r as e,o as s,f as u,g as r,i as n,k as i,l as v,m as t,aq as o,h as c,A as d,j as p,U as m,x as f,av as g,$ as y,y as b,z as k,ar as _,a1 as h,as as $,J as j,a3 as z}from"./vendor-Ct0GE2cv.js";import{_ as I,u as w,i as x}from"./index-D-heiWuO.js";import{a as C}from"./formatDate-_UAqMSvc.js";const U={class:"user-page"},A={key:0,class:"user-profile"},q={class:"user-details"},D={key:1,class:"album-grid"},J={key:1,class:"none-cover"},P={key:0,class:"pagination"},B=I({__name:"UserPage",setup(I){const B=a(),E=l(),F=w(),G=e(null),H=e(null),K=e([]),L=e(!1),M=e(!1),N=e(1),O=e(10),Q=e(0),R=async a=>{var l;M.value=!0,K.value=[],Q.value=0;try{const{data:l}=await x.post(`/api/public/users/${a}/albums`,z.stringify({page:N.value,limit:O.value}));K.value=l.albums||[],Q.value=l.total||0}catch({response:e}){j.error((null==(l=null==e?void 0:e.data)?void 0:l.error)||"获取公开相册列表失败")}finally{M.value=!1}},S=a=>{N.value=a,R(G.value)};return s((()=>{G.value=B.params.userId,(async a=>{var l;L.value=!0,H.value=null;try{const{data:l}=await x.post(`/api/public/users/${a}`,{});H.value=l}catch({response:e}){j.error((null==(l=null==e?void 0:e.data)?void 0:l.error)||"获取用户信息失败")}finally{L.value=!1}})(G.value),N.value=1,R(G.value)})),(a,l)=>{const e=d,s=g,j=o,z=y,I=h,w=_,x=$;return r(),u("div",U,[n(z,{class:"user-info-card"},{default:t((()=>[n(j,{spinning:L.value},{default:t((()=>{var a,l,v;return[H.value?(r(),u("div",A,[n(e,{src:(null==(v=null==(l=null==(a=p(F))?void 0:a.config)?void 0:l.site)?void 0:v.url)+H.value.avatar,size:80,icon:p(m)},null,8,["src","icon"]),c("div",q,[c("h2",null,f(H.value.username),1),c("p",null,"注册时间: "+f(p(C)(H.value.createdAt)),1)])])):(r(),i(s,{key:1,description:"用户不存在"}))]})),_:1},8,["spinning"])])),_:1}),H.value?(r(),i(z,{key:0,class:"public-albums-card"},{default:t((()=>{var a,e,o,d;return[c("h3",null,f((null==(a=H.value)?void 0:a.username)===(null==(o=null==(e=p(F))?void 0:e.user)?void 0:o.username)?"我":null==(d=H.value)?void 0:d.username)+"的公开相册",1),n(j,{spinning:M.value},{default:t((()=>[0!==K.value.length||M.value?(r(),u("div",D,[(r(!0),u(b,null,k(K.value,(a=>(r(),u("div",{key:a._id,class:"album-item"},[n(z,{hoverable:"",onClick:l=>p(E).push(`/user/${G.value}/album/${a._id}`)},{cover:t((()=>{var l,e,s;return[a.coverImage?(r(),i(I,{key:0,src:(null==(s=null==(e=null==(l=p(F))?void 0:l.config)?void 0:e.site)?void 0:s.url)+a.coverImage.thumb,preview:!1},null,8,["src"])):(r(),u("div",J,"无封面"))]})),default:t((()=>[n(w,{title:a.name},null,8,["title"])])),_:2},1032,["onClick"])])))),128))])):(r(),i(s,{key:0,description:"暂无公开相册"}))])),_:1},8,["spinning"]),Q.value>O.value?(r(),u("div",P,[n(x,{current:N.value,"onUpdate:current":l[0]||(l[0]=a=>N.value=a),total:Q.value,"page-size":O.value,onChange:S},null,8,["current","total","page-size"])])):v("",!0)]})),_:1})):v("",!0)])}}},[["__scopeId","data-v-cf457fb4"]]);export{B as default};
